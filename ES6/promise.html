<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Promise</title>
</head>

<body>
    <script>
        var url = "https://api.apiopen.top/getJoke?page=1&count=5&type-video"
        function getAjax(httpUrl) {
            return new Promise((res, rej) => {
                var xhr = new XMLHttpRequest();
                //2.设置请求路径和方法,get会将数据拼接到请求路径里，效率高
                //POST会将数据请求拼接到body里面，数据大，安全
                xhr.open("GET", httpUrl);

                //3.监听后台是否返回数据
                xhr.onreadystatechange = function () {
                    if (xhr.status == 200 && xhr.readyState == 4) {
                        //5. 处理获取得到的数据
                        res(xhr);
                    } else if (!xhr.status == 200 && xhr.readyState == 4) {
                        //6. 处理失败结果
                        rej(xhr);
                    }
                };
                //4.发送数据
                xhr.send();
            });
            // console.log(ajaxP);
        }
        // var ajaxP = getAjax(url);
        // console.log(ajaxP);

        // ajaxP.then((res)=>{
        //     var data = JSON.parse(res.responseText);
        //     console.log(data);

        // }).catch((error)=>{
        //     console.log(error);
        // })
        fetch(url).then((res)=>{
            console.log(res.json);
            var result = res.json();
            result.then((result)=>{
                console.log(result);
            })
            
        })

    </script>
</body>

</html>