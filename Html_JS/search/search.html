<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Search</title>
    <link rel="stylesheet" href="search.css" />
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <div class="main">
      <div class="icon">
        <div class="img"></div>
        <!-- <img src="../img/icon/search.png" alt="" srcset=""> -->
      </div>

      <div class="search-page">
        <!-- <form class="search-bar" action="https://search.douban.com/movie/subject_search" method="get"> -->
        <div class="search-bar">
          <input
            class="search-text"
            type="search"
            name="search_text"
            placeholder=" Search the movie"
          />
          <input class="search-btn" type="button" value="search" />
        </div>
      </div>

      <div class="show-page">
        <!-- <div class="item">
                <div class="item-img"></div>
                <div class="item-name">通往春天的列车</div>
                <div class="item-year">2012</div>
                <div class="item-brief">一个小故事极大更加疯狂地根本港二</div>
            </div> -->
        <!-- <div class="item">
                <div class="item-img"></div>
                <div class="item-name">通往春天的列车</div>
                <div class="item-year">2012</div>
                <div class="item-brief">一个小故事极大更加疯狂地根本港二</div>
            </div> -->
        <!-- <div class="item">
                <div class="item-img"></div>
                <div class="item-name">通往春天的列车</div>
                <div class="item-year">2012</div>
                <div class="item-brief">一个小故事极大更加疯狂地根本港二</div>
            </div> -->
      </div>
    </div>

    <!-- <script src="getAjax.js"></script> -->
    <script type="module">
      var searchImgDiv = document.querySelector(".img");
      var searchBarDiv = document.querySelector(".search-page");
      var showPageDiv = document.querySelector(".show-page");
      var searchBtn = document.querySelector(".search-btn");
      var searchText = document.querySelector(".search-text");
      const inputElement = document.querySelector('input[type="text"]');
      var itemList = [];
      var isInputZh = false;
      var body = document.querySelector("body");
      var movieName = "千与千寻";
      var movieId = "";


      var http = `https://api.jisuapi.com/movie/detail?movieid=${movieId}&moviename=${movieName}&appkey=cf1cd9bb52358324`;
      // var http = "https://api.apiopen.top/getJoke?page=1&count=10&type-video;"
      var itemList = [];
      $.ajax({
        dataType: "jsonp",
        url: http,
        success: function (data) {
          //处理data数据
          itemList = data.result;
          console.log(itemList.length);
          movieName = itemList.moviename;

          console.log(data);
          //   console.log(itemList[moviename]);
        },
      });
      //   console.log(movieName+"new");

      searchImgDiv.onclick = function () {
        searchBarDiv.style.display = "block";
      };

      /*       searchText.onkeypress = function(e){
        console.log(e);
        movieName = e.key;
        // console.log(movieName+" 里");
    } */

/*       searchText.addEventListener(
        "compositionstart",
        function (e) {
          isInputZh = true;
        },
        false
      );
      searchText.addEventListener(
        "compositionend",
        function (e) {
          isInputZh = false;
          movieName = searchText.value;
          console.log(movieName + "compositionend");
        },
        false
      );
      searchText.addEventListener(
        "input",
        function (e) {
          if (isInputZh) {
            movieName = searchText.value;
          }
          movieName = this.value;
          console.log(movieName + "input");
        },
        false
      ); */

    //   console.log(movieName + "new");

      searchBtn.onclick = function (e) {
        console.log(e);

        $.ajax({
          dataType: "jsonp",
          url: http,
          success: function (data) {
            //处理data数据
            itemList = data.result;
            movieName = itemList.moviename;

          },
        });
      };

/*       function renderItem(itemList) {
        itemList.forEach(function (item, i) {
          itemDiv = document.createElement("div");
          itemDiv.className = "show-page";
          itemDiv.innerHTML = `
        <div class="item">
                <div class="item-img"></div>
                <div class="item-name">${item.name}</div>
                <div class="item-year">${item.passtime}</div>
                <div class="item-brief">${item.text}</div>
        </div>
        `;
          showPageDiv.appendChild(itemDiv);
        });
      } */

      // console.log(movieName+"外");
    </script>
    <!-- <script src="search.js"></script> -->
  </body>
</html>
